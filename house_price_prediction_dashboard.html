<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>House Price Prediction Dashboard</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
  <style>
    body { background: #f7f9fc; }
    .card { border-radius: 12px; }
    .range-value { min-width: 60px; display:inline-block }
    .small-muted { font-size: .85rem; color: #6c757d }
  </style>
</head>
<body>
  <div class="container py-4">
    <div class="d-flex align-items-center mb-4">
      <h2 class="me-3">üè† House Price Prediction Dashboard</h2>
      <small class="text-muted">Estimate prices from user inputs (frontend demo)</small>
    </div>

    <div class="row g-3">
      <div class="col-lg-5">
        <div class="card p-3 shadow-sm">
          <h5>Input Features</h5>

          <div class="mb-3">
            <label class="form-label">Location (city/neighborhood)</label>
            <select id="location" class="form-select">
              <option value="1.0">City Center (High demand)</option>
              <option value="0.9">Inner Suburb</option>
              <option value="0.75">Outer Suburb</option>
              <option value="0.6">Rural / Low demand</option>
            </select>
            <div class="small-muted">Use location multiplier to reflect supply/demand.</div>
          </div>

          <div class="mb-3">
            <label class="form-label">Square Footage (sqft)</label>
            <input id="sqft" type="number" class="form-control" min="100" max="20000" value="1200">
          </div>

          <div class="row">
            <div class="col-6 mb-3">
              <label class="form-label">Bedrooms</label>
              <input id="beds" type="number" class="form-control" min="0" max="10" value="3">
            </div>
            <div class="col-6 mb-3">
              <label class="form-label">Bathrooms</label>
              <input id="baths" type="number" class="form-control" min="0" max="10" value="2">
            </div>
          </div>

          <div class="mb-3">
            <label class="form-label">Year built</label>
            <input id="yearBuilt" type="number" class="form-control" min="1800" max="2025" value="2005">
            <div class="small-muted">Age affects price (newer -> higher).</div>
          </div>

          <div class="mb-3">
            <label class="form-label">Lot size (sqft)</label>
            <input id="lot" type="number" class="form-control" min="100" max="100000" value="4000">
          </div>

          <div class="mb-3">
            <label class="form-label">Has garage?</label>
            <select id="garage" class="form-select">
              <option value="1">Yes</option>
              <option value="0">No</option>
            </select>
          </div>

          <div class="d-flex gap-2">
            <button id="predictBtn" class="btn btn-primary">Predict Price</button>
            <button id="resetBtn" class="btn btn-outline-secondary">Reset</button>
          </div>

          <hr>
          <div>
            <h6>Model details (frontend demo)</h6>
            <p class="small-muted">This page uses a simple, explainable linear model implemented in JavaScript for demo purposes. Replace with a real model or API for production.</p>
          </div>
        </div>
      </div>

      <div class="col-lg-7">
        <div class="card p-3 shadow-sm">
          <h5>Prediction</h5>
          <div class="d-flex align-items-end gap-3">
            <div>
              <div class="fs-5 small-muted">Estimated Market Price</div>
              <div id="predictedPrice" class="display-6 fw-bold mt-2">--</div>
              <div id="breakdown" class="small-muted mt-2">Feature contribution breakdown will appear here.</div>
            </div>
            <div class="ms-auto text-end">
              <div class="small-muted">Currency</div>
              <div class="fw-semibold">INR (‚Çπ)</div>
            </div>
          </div>

          <hr>

          <div>
            <canvas id="priceChart" height="120"></canvas>
          </div>

          <hr>

          <div>
            <h6>What you can do next</h6>
            <ul>
              <li>Integrate with a Flask / FastAPI / Node endpoint that serves a trained ML model (Pickle, ONNX, or TF SavedModel).</li>
              <li>Collect real data and re-train using scikit-learn / XGBoost / LightGBM then call the API from this page.</li>
              <li>Add explanation tools (SHAP) on the backend and surface local explanations here.</li>
            </ul>
          </div>
        </div>
      </div>
    </div>

    <footer class="mt-4 text-center small text-muted">Demo dashboard ‚Ä¢ Not for production pricing</footer>
  </div>

<script>
// --- Simple demo prediction model ---
// This uses a linear formula with handcrafted coefficients as a client-side placeholder.

function predictPrice(features){
  // features: {sqft, beds, baths, yearBuilt, lot, garage, locationMultiplier}
  // Base price per sqft (city-center baseline)
  const basePerSqft = 4500; // rupees per sqft (example)

  // Coefficients (hand-tuned for demo purposes)
  const coeff = {
    sqft: 1.0,
    beds: 70000,    // per bedroom
    baths: 50000,   // per bathroom
    ageFactor: -0.006, // multiplied by age to reduce price
    lotSqft: 12,    // contribution per lot sqft
    garage: 45000   // fixed if garage
  };

  const currentYear = new Date().getFullYear();
  const age = Math.max(0, currentYear - features.yearBuilt);

  // Linear combination
  let price = basePerSqft * features.sqft * features.locationMultiplier;
  price += coeff.beds * features.beds;
  price += coeff.baths * features.baths;
  price += coeff.lotSqft * Math.sqrt(features.lot); // diminishing returns: use sqrt
  price += features.garage * coeff.garage;
  price += price * (coeff.ageFactor * age); // age reduces price proportionally

  // Add small random noise to simulate market variance (for demo only)
  const noise = (Math.random() - 0.5) * 0.03 * price;
  price += noise;

  // Floor and return
  return Math.max(0, Math.round(price));
}

function getFeatureContributions(features){
  const basePerSqft = 4500;
  const currentYear = new Date().getFullYear();
  const age = Math.max(0, currentYear - features.yearBuilt);

  const sqftContribution = Math.round(basePerSqft * features.sqft * features.locationMultiplier);
  const bedsContribution = Math.round(70000 * features.beds);
  const bathsContribution = Math.round(50000 * features.baths);
  const lotContribution = Math.round(12 * Math.sqrt(features.lot));
  const garageContribution = features.garage ? 45000 : 0;
  const agePenalty = Math.round((sqftContribution + bedsContribution + bathsContribution + lotContribution + garageContribution) * ( -0.006 * age));

  return {
    sqft: sqftContribution,
    beds: bedsContribution,
    baths: bathsContribution,
    lot: lotContribution,
    garage: garageContribution,
    agePenalty: agePenalty
  }
}

// Chart setup
let priceChart;
function initChart(){
  const ctx = document.getElementById('priceChart');
  priceChart = new Chart(ctx, {
    type: 'bar',
    data: {
      labels: ['Predicted Price', 'Median Price (sample)'],
      datasets: [{
        label: 'Price (‚Çπ)',
        data: [0, 0],
        backgroundColor: ['rgba(54, 162, 235, 0.6)', 'rgba(201, 203, 207, 0.6)'],
        borderRadius: 6
      }]
    },
    options: {
      responsive: true,
      scales: {
        y: { beginAtZero: true }
      },
      plugins: { legend: { display: false } }
    }
  });
}

function updateChart(predicted, sampleMedian){
  priceChart.data.datasets[0].data = [predicted, sampleMedian];
  priceChart.update();
}

// UI bindings
function readInputs(){
  const sqft = Number(document.getElementById('sqft').value) || 0;
  const beds = Number(document.getElementById('beds').value) || 0;
  const baths = Number(document.getElementById('baths').value) || 0;
  const yearBuilt = Number(document.getElementById('yearBuilt').value) || new Date().getFullYear();
  const lot = Number(document.getElementById('lot').value) || 0;
  const garage = Number(document.getElementById('garage').value) || 0;
  const locationMultiplier = Number(document.getElementById('location').value) || 1.0;
  return {sqft, beds, baths, yearBuilt, lot, garage, locationMultiplier};
}

function formatINR(x){
  return '‚Çπ ' + x.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
}

function onPredict(){
  const features = readInputs();
  const predicted = predictPrice(features);
  const contributions = getFeatureContributions(features);

  document.getElementById('predictedPrice').textContent = formatINR(predicted);

  // Create a small breakdown
  const breakdown = `Sqft: ${formatINR(contributions.sqft)} | Beds: ${formatINR(contributions.beds)} | Baths: ${formatINR(contributions.baths)} | Lot: ${formatINR(contributions.lot)} | Garage: ${formatINR(contributions.garage)} | Age effect: ${formatINR(contributions.agePenalty)}`;
  document.getElementById('breakdown').textContent = breakdown;

  // For demo, sample median is a simple function of location and sqft
  const sampleMedian = Math.round(0.85 * (4500 * features.sqft * features.locationMultiplier));
  updateChart(predicted, sampleMedian);
}

function onReset(){
  document.getElementById('sqft').value = 1200;
  document.getElementById('beds').value = 3;
  document.getElementById('baths').value = 2;
  document.getElementById('yearBuilt').value = new Date().getFullYear() - 20;
  document.getElementById('lot').value = 4000;
  document.getElementById('garage').value = 1;
  document.getElementById('location').value = 1.0;
  document.getElementById('predictedPrice').textContent = '--';
  document.getElementById('breakdown').textContent = 'Feature contribution breakdown will appear here.';
  updateChart(0,0);
}

// Initialisation
window.addEventListener('DOMContentLoaded', () =>{
  initChart();
  document.getElementById('predictBtn').addEventListener('click', onPredict);
  document.getElementById('resetBtn').addEventListener('click', onReset);
  // populate sensible default year
  document.getElementById('yearBuilt').value = new Date().getFullYear() - 20;
});
</script>

</body>
</html>
